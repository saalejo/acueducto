import{u as P,a as V,b as j,c as D,d as F,Q as H,i as J,e as K,f as O,g as R,h as k,j as T}from"./messages.498fa53e.js";import{H as w,ag as z,r as u,c as _,o as A,I as d,J as b,M as Q,d as r,K as G,L as n,F as U,ah as W,N as X,P as B,R as C,ai as y,$ as Y,aj as Z}from"./index.967cd7d7.js";import{u as ee}from"./configuracion-store.545ed142.js";import{api as L}from"./axios.12b0c425.js";import"./use-dark.c94485d5.js";const te={class:"col q-pa-md"},ae={class:"row fixed-bottom-right"},oe={class:"col q-pa-md"},se=w({__name:"RutasComponent",setup(E){const c=P(),p=z(),I=ee(),v=V(),f=j(),M=D(),N=F(),h=u(_(()=>I.obtener)),o=u(_(()=>f.obtener));u(_(()=>v.obtener));const l=u([]),g=e=>{e.rutaStore&&(v.modificar(e.rutaStore),N.modificar(e.rutaStore.lecturas[0]),e.rutaStore.selected=!0,e.rutaStore.lecturas.forEach(t=>{l.value.includes(t.consumo.sector)||(l.value=l.value.concat([t.consumo.sector]))}),M.modificar(l.value),p.push({path:"/ruta"}))},S=(e,t)=>{c.loading.show();const a="/rutas/"+e.id;L.get(a).then(i=>{const s=i.data;e.rutaStore=s,f.modificar(o.value),t&&g(e)}).catch(()=>{c.notify(K)}).finally(()=>{c.loading.hide()})},x=()=>{if(h.value.token){c.loading.show();const e="/ruta_simple/?dispositivo__codigo="+h.value.token;L.get(e).then(t=>{const a=t.data,i=u([]);o.value.forEach(s=>{a.find(m=>m.id==s.id)||o.value.splice(o.value.indexOf(s),1)}),a.forEach(s=>{o.value.find(m=>m.id==s.id)||(i.value=i.value.concat([s]),S(s,!1))}),f.modificar(i.value.concat(o.value))}).catch(t=>{c.notify(J)}).finally(()=>{c.loading.hide()})}},$=e=>{const t=o.value.find(a=>a.id==e.id);o.value.forEach(a=>a.selected==!1),t.selected=!0,t.rutaStore?g(t):S(t,!0)};return A(x),(e,t)=>(d(),b("div",te,[Q("div",ae,[Q("div",oe,[r(G,{onClick:x,icon:"refresh",round:"",color:"primary"})])]),r(H,{bordered:"",separator:""},{default:n(()=>[(d(!0),b(U,null,W(o.value,a=>X((d(),B(O,{clickable:"",key:a.id,onClick:i=>$(a)},{default:n(()=>[r(R,null,{default:n(()=>[r(k,null,{default:n(()=>[C(y(a.vereda),1)]),_:2},1024),r(k,{caption:""},{default:n(()=>[C(y(a.fecha),1)]),_:2},1024)]),_:2},1024),r(R,{side:""},{default:n(()=>[r(Y,{name:"done"})]),_:1})]),_:2},1032,["onClick"])),[[Z]])),128))]),_:1})]))}}),le=w({__name:"RutasPage",setup(E){return(c,p)=>(d(),B(T,{class:"row"},{default:n(()=>[r(se)]),_:1}))}});export{le as default};
